{"name":"Mongodb-orm","tagline":"Java ORM for MongoDB","body":"# mongodb-orm简介\r\n\r\n* Mongodb ORM是基于java的ORM框架，简化了SDK的使用，使代码变得更清晰、简单。 </br>\r\n* 与Ibatis类似，将查询、执行语句封装在xml中，与代码隔离。简称MQL。 </br>\r\n\r\n\r\n# 项目中使用\r\n\r\n#### 加入mongodb orm的支持包\r\n\r\n* 1. 添加jar包或maven支持\r\n\r\n```\r\n<dependency>\r\n\t<groupId>com.mongodborm</groupId>\r\n  \t<artifactId>mongodb-orm</artifactId>\r\n  \t<version>0.0.1-RELEASE</version>\r\n</dependency>\r\n```\r\n\r\n* 2. 初始化mongodb templet\r\n\r\n> spring中初始化\r\n\r\n```xml\r\n<bean id=\"mongoTemplet\" class=\"com.mongodb.client.MongoClientTemplet\">\r\n    <property name=\"factory\">\r\n        <bean class=\"com.mongodb.client.MongoORMFactoryBean\">\r\n            <property name=\"dataSource\">\r\n                <bean class=\"com.mongodb.client.MongoDataSource\">\r\n                    <property name=\"nodeList\" value=\"127.0.0.1:27017\" />\r\n\t\t\t\t\t<property name=\"dbName\" value=\"your db name\" />\r\n\t\t\t\t\t<property name=\"userName\" value=\"user name\" />\r\n\t\t\t\t\t<property name=\"passWord\" value=\"password\" />\r\n\t\t\t\t\t<!-- 可使用默认值 -->\r\n\t\t\t\t\t<property name=\"connectionsPerHost\" value=\"\" />\r\n\t\t\t\t\t<property name=\"threadsAllowedToBlock\" value=\"\" />\r\n\t\t\t\t\t<property name=\"connectionTimeOut\" value=\"\" />\r\n\t\t\t\t\t<property name=\"maxRetryTime\" value=\"\" />\r\n\t\t\t\t\t<property name=\"socketTimeOut\" value=\"\" />\r\n                </bean>\r\n            </property>\r\n            <property name=\"configLocations\">\r\n                <list>\r\n\t\t\t\t\t<value>classpath:mql/mongo-mql.xml</value>\r\n\t\t\t\t</list>\r\n            </property>\r\n        </bean>\r\n    </property>\r\n</bean>\r\n```\r\n\r\n> 代码初始化\r\n\r\n```java\r\n\ttry {\r\n      Resource resource =  new ClassPathResource(\"mongo-mql.xml\");    \r\n      MongoORMFactoryBean factory = new MongoORMFactoryBean();\r\n      factory.setConfigLocations(new Resource[]{resource});\r\n      factory.init();   \r\n      MongoClientTemplet templet = new MongoClientTemplet();\r\n      templet.setFactory(factory);\r\n      templet.init();\r\n    } catch(Exception e) {\r\n      e.printStackTrace();\r\n    }\r\n```\r\n\r\n#### 编写MQL\r\n\r\n* Mapping\r\n\r\n```xml\r\n<mapping id=\"model\" class=\"test.mongodborm.Model\">\r\n\t\t<property column=\"_id\" name=\"id\" />\r\n\t\t<property column=\"name\" name=\"name\" />\r\n\t\t<property column=\"time\" name=\"time\" value=\"0\" />\r\n\t\t<property column=\"status\" name=\"status\" />\r\n</mapping>\r\n\r\n<mapping id=\"extendModel\" class=\"test.mongodborm.Model\" extends=\"model\">\r\n\t<property column=\"newProperty\" name=\"newProperty\" />\r\n</mapping>\r\n```\r\n\r\n* select\r\n\r\n```xml\r\n<select id=\"queryModelList\" collection=\"test_sample\">\r\n\t<query class=\"java.lang.String\">\r\n\t\t<property column=\"name\" name=\"${value}\" />\r\n\t</query>\r\n\t<field mapping=\"model\" />\r\n\t<order>\r\n\t\t<property column=\"time\" value=\"desc\" />\r\n\t</order>\r\n</select>\r\n```\r\n\r\n* update/findAndModify\r\n\r\n```xml\r\n<update id=\"updateModel\" collection=\"test_sample\">\r\n\t<query class=\"test.mongodborm.Model$Child\">\r\n\t\t<property column=\"name\" name=\"name\" ignoreNull=\"true\" />\r\n\t\t<property column=\"time\" operate=\"gte\" value=\"0\" type=\"number\" />\r\n\t\t<property column=\"status\" operate=\"in\">\r\n\t\t\t<list type=\"number\">0,1</list>\r\n\t\t</property>\r\n\t</query>\r\n\t<action class=\"java.util.Map\">\r\n\t\t<property column=\"name\" name=\"name\" operate=\"set\" />\r\n\t\t<property column=\"status\" operate=\"set\" />\r\n\t</action>\r\n</update>\r\n```\r\n\r\n* 有嵌套的查询\t\r\n\r\n```xml\r\n<select id=\"queryModelList3\" collection=\"test_sample\">\r\n\t<query class=\"java.lang.String\">\r\n\t\t<property column=\"_id\" value=\"${value}\" />\r\n\t\t<property column=\"time\" value=\"0\" type=\"number\" />\r\n\t</query>\r\n\t<field class=\"java.util.Map\">\r\n\t\t<property column=\"name\" name=\"name\" />\r\n\t\t<property column=\"parent\" name=\"parent\">\r\n\t\t\t<value class=\"test.mongodborm.Model$Parent\">\r\n\t\t\t\t<property column=\"name\" name=\"name\" />\r\n\t\t\t\t<property column=\"child\" name=\"child\">\r\n\t\t\t\t\t<value class=\"test.mongodborm.Model$Child\">\r\n\t\t\t\t\t\t<property column=\"name\" name=\"name\" />\r\n\t\t\t\t\t\t<property column=\"time\" name=\"time\" value=\"0\" />\r\n\t\t\t\t\t</value>\r\n\t\t\t\t</property>\r\n\t\t\t\t<property column=\"data\" name=\"data\">\r\n\t\t\t\t\t<value class=\"java.util.Map\">\r\n\t\t\t\t\t\t<property column=\"title\" name=\"title\" />\r\n\t\t\t\t\t\t<property column=\"content\" name=\"content\" />\r\n\t\t\t\t\t</value>\r\n\t\t\t\t</property>\r\n\t\t\t</value>\r\n\t\t</property>\r\n\t\t<property column=\"data\" name=\"data\">\r\n\t\t\t<value class=\"java.util.Map\">\r\n\t\t\t\t<property column=\"title\" name=\"title\" />\r\n\t\t\t\t<property column=\"content\" name=\"content\" />\r\n\t\t\t</value>\r\n\t\t</property>\r\n\t</field>\r\n\t<order class=\"java.util.Map\">\r\n\t\t<property column=\"time\" name=\"time\" value=\"desc\" />\r\n\t</order>\r\n</select>\r\n```\r\n\r\n#### Templet用法\r\n\r\n```java\r\nModel model = mongoTemplet.findOne(\"queryModelList\", \"yuxiangping\");\r\n\r\nList<Model> list = mongoTemplet.findOne(\"queryModelList\", \"\");\r\n\r\nModel model = new Model();\r\nmodel.setTime(1L);\r\nMap<String, String> action = new HashMap<String, String>();\r\naction.put(\"name\", \"yuxiangping-update\");\r\nint update = mongoT emplet.update(\"updateModel\", model, action);\r\n```\r\n\r\n> 更多的使用方法参见  [sample.xml](https://github.com/yuxiangping/mongodb-orm/blob/master/src/main/resources/sample-sql.xml)\r\n\r\n\r\n# 资料\r\n\r\n [使用教程](https://github.com/yuxiangping/mongodb-orm/wiki)\r\n\r\n [Issues](https://github.com/yuxiangping/mongodb-orm/issues)\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}